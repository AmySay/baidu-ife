<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>任务六：UI组件之浮出层</title>
</head>
<style>
    .showModal{
        position: absolute;
        top : 10px;
        left:50%;
        transform: translate(-50%);
    }
    /*modalCover的样式*/
    .coverModal{
        display: none;
        position: absolute;
        top:50%;
        left:50%;
        transform: translate(-50%,-50%);
        z-index: 999;
        box-shadow:0 0 10px;
        background: #fff;
    }
    .coverModal p{
        margin-top:160px;
        display: flex;
        justify-content: space-around;
    }
    .coverModal p span{
        padding:5px;
        background: greenyellow;
    }
    html,body{
        width: 100%;
        height:100%;
    }
    .coverModalPop{
        display: none;
        width:100%;
        height:100%;
        z-index:998;
        background: rgba(0,0,0,0.6);
    }
</style>
<body>
    <button class="showModal">弹出</button>
    <div class = "coverModal" >
        <p>
            <span>
                确定
            </span>
            <span>
                关闭
            </span>
        </p>
    </div>
</body>
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script>
    window.onload = function () {
        $(document).on("click",".showModal",function () {
            modalCoverFn.initShow(500,200);
        })
        $(document).on("click",".coverModal span",function () {
            modalCoverFn.initHide();
        })
        $(document).on("click",function (e) {
            if($(".coverModal")[0].style.display == "block"){
                if(e.target == $(".coverModalPop")[0]){
                    modalCoverFn.initHide();
                }
            }
        })
    }
    var modalCoverFn = {
        initShow:function (w,h) {
            $('<div class = "coverModalPop"></div>').appendTo($("body"));
            $(".coverModalPop").show();
            $(".coverModal").css({
                "width":w,
                "height":h
            }).show();
        },
        initHide : function () {
            $(".coverModalPop").hide();
            $(".coverModal").hide();
        }
    }


//    (function($){
//        $.fn.myPlugin = function(options) {
//            var $doc = $(document);
//            var defaults = {
//                parentdraf : '.J-xloginPanel' , // 拖拽元素父级
//                draftin : '.J-xloginPanel h3' , // 拖拽元素
//                sizeLeft : '.J-xloginPanel .barl', // 改变大小左边
//                sizeRight : '.J-xloginPanel .barr', // 改变大小右边
//                sizeTop : '.J-xloginPanel .bart', // 改变大小上边
//                sizeBottom : '.J-xloginPanel .barb',  // 改变大小下边
//                sizeSkew : '.J-xloginPanel .bar'
//            };
//            var settings = $.extend({} , defaults, options);
//
//            /* 拖拽 */
//            $(settings.draftin).on('mousedown' , dragmove);
//            function dragmove(event){
//                event = event || window.event;
//                var disX = event.pageX - $(settings.parentdraf).offset().left;
//                var disY = event.pageY - $(settings.parentdraf).offset().top;
//                $doc.on('mousemove',move);
//                function move(event){
//                    event = event || window.event;
//                    var mouseX = event.pageX - disX;
//                    var mouseY = event.pageY - disY;
//                    var maxX = document.documentElement.clientWidth - $(settings.parentdraf).outerWidth(),
//                        maxY = document.documentElement.clientHeight - $(settings.parentdraf).outerHeight();
//                    if(mouseX < 0){
//                        mouseX = 0;
//                    }else if(mouseX > maxX){
//                        mouseX = maxX;
//                    }
//                    if(mouseY < 0){
//                        mouseY = 0;
//                    }else if(mouseY > maxY){
//                        mouseY = maxY;
//                    }
//                    $(settings.parentdraf).css({'left' : mouseX+'px','top':mouseY+'px'});
//                };
//            };
//
//            /* 左边 */
//            $(settings.sizeLeft).on('mousedown' , function(event){
//                event = event || window.event;
//                var $this = $(this);
//                var disX = $(settings.parentdraf).offset().left,
//                    drafw = $(settings.parentdraf).width();
//                $doc.on('mousemove' , function(event){
//                    event = event || window.event;
//                    var mouseX = event.pageX;
//                    if(mouseX < 0)mouseX=0;
//                    $(settings.parentdraf).css({'left':mouseX +'px' , 'width':(disX-mouseX-4)+drafw +'px'})
//                });
//            });
//
//            /* 右边 */
//            $(settings.sizeRight).on('mousedown' , function(event){
//                event = event || window.event;
//                var $this = $(this);
//                var disX = $(settings.parentdraf).offset().left;
//                $doc.on('mousemove' , function(event){
//                    event = event || window.event;
//                    var mouseX = event.pageX-disX,
//                        maxX = document.documentElement.clientWidth - disX - 2;
//                    if(mouseX > maxX)mouseX = maxX;
//                    $(settings.parentdraf).css({'width':mouseX +'px'})
//                });
//            });
//
//            /* 上边 */
//            $(settings.sizeTop).on('mousedown' , function(event){
//                event = event || window.event;
//                var $this = $(this);
//                var disY = $(settings.parentdraf).offset().top,
//                    drafH = $(settings.parentdraf).height();
//                $doc.on('mousemove' , function(event){
//                    event = event || window.event;
//                    var mouseY = event.pageY,
//                        range = disY-mouseY-4;
//                    if(mouseY+4 > 0){
//                        $(settings.parentdraf).css({'top':mouseY +'px' , 'height':range+drafH +'px'});
//                    };
//                });
//            });
//
//            /* 下边 */
//            $(settings.sizeBottom).on('mousedown' , function(event){
//                event = event || window.event;
//                var $this = $(this);
//                var disY = $(settings.parentdraf).offset().top;
//                $doc.on('mousemove' , function(event){
//                    event = event || window.event;
//                    var mouseY = event.pageY-disY,
//                        maxY = document.documentElement.clientHeight - disY - 2;
//                    if(mouseY > maxY)mouseY = maxY;
//                    $(settings.parentdraf).css({'height':mouseY +'px'});
//                });
//            });
//
//            /* 下斜 */
//            $(settings.sizeSkew).on('mousedown' , function(event){
//                event = event || window.event;
//                var $this = $(this),
//                    disX = $(settings.parentdraf).offset().left,
//                    disY = $(settings.parentdraf).offset().top;
//                $doc.on('mousemove' , function(event){
//                    event = event || window.event;
//                    var mouseX = event.pageX - disX + 14,
//                        mouseY = event.pageY - disY + 14,
//                        maxX = document.documentElement.clientWidth - disX - 2,
//                        maxY = document.documentElement.clientHeight - disY - 2;
//                    if(mouseX > maxX)mouseX = maxX;
//                    if(mouseY > maxY)mouseY = maxY;
//                    $(settings.parentdraf).css({'width':mouseX +'px' , 'height':mouseY + 'px'});
//                });
//            });
//
//            /* 松开鼠标 */
//            $doc.mouseup(function(){
//                $doc.off('mousedown')
//                $doc.off('mousemove')
//            });
//        };
//        $(document).ready(function(){
//            $('body').myPlugin();
//        });
//    })(jQuery);

    $('.coverModal').mousedown(function(e) {
        var positionDiv = $(this).offset();
        var w = $(this).width();
        var h = $(this).height();
        var distenceX = e.pageX - positionDiv.left;
        var distenceY = e.pageY - positionDiv.top;
        $(document).mousemove(function(e) {
            var x = e.pageX - distenceX;
            var y = e.pageY - distenceY;

            if (x < 0) {
                x = 0;
            } else if (x > $(document).width() - $('div').outerWidth(true)) {
                x = $(document).width() - $('div').outerWidth(true);
            }

            if (y < 0) {
                y = 0;
            } else if (y > $(document).height() - $('div').outerHeight(true)) {
                y = $(document).height() - $('div').outerHeight(true);
            }

            $('div').css({
                'left': x + w/2  + 'px',
                'top': y + h/2 + 'px'
            });
        });

        $(document).mouseup(function() {
            $(document).off('mousemove');
        });
    });
</script>
</html>